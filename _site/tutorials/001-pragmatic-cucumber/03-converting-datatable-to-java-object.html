<!DOCTYPE html>
<html lang=" en-US">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="cache-control" content="max-age=0" />
    <meta http-equiv="cache-control" content="no-cache" />
    <meta http-equiv="expires" content="0" />
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
    <meta http-equiv="pragma" content="no-cache" />
    <title>Madras Coder</title>
    <link rel="apple-touch-icon" sizes="180x180" href="/assets/images/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/assets/images/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/assets/images/favicon-16x16.png">
    <link rel="manifest" href="/assets/images/site.webmanifest">
    <link rel="stylesheet" href="/assets/css/main.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.1/css/all.min.css">
    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link href="https://fonts.googleapis.com/css2?family=Roboto+Slab:wght@300;400;500;600;700&display=swap"
        rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script>
    <link type="application/atom+xml" rel="alternate" href="https://www.madrascoder.com/feed.xml" title="Madras Coder" />
    <!-- Begin Jekyll SEO tag v2.7.1 -->
<title>How to Convert a DataTable into a Java Object | Madras Coder</title>
<meta name="generator" content="Jekyll v4.2.0" />
<meta property="og:title" content="How to Convert a DataTable into a Java Object" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="This chapter is continuation of ‘Different patterns of creating Cucumber Feature files’ with more real use case. In this chapter, let us see 3 patterns to represent complex objects in feature files. In a real use case, we may need to convert the DataTable to a JSON so that we can use that as payload to call REST API from step definition. If we can convert DataTable to a Java Object, we can easily convert that to a JSON." />
<meta property="og:description" content="This chapter is continuation of ‘Different patterns of creating Cucumber Feature files’ with more real use case. In this chapter, let us see 3 patterns to represent complex objects in feature files. In a real use case, we may need to convert the DataTable to a JSON so that we can use that as payload to call REST API from step definition. If we can convert DataTable to a Java Object, we can easily convert that to a JSON." />
<link rel="canonical" href="https://www.madrascoder.com/tutorials/001-pragmatic-cucumber/03-converting-datatable-to-java-object.html" />
<meta property="og:url" content="https://www.madrascoder.com/tutorials/001-pragmatic-cucumber/03-converting-datatable-to-java-object.html" />
<meta property="og:site_name" content="Madras Coder" />
<meta property="og:image" content="https://www.madrascoder.com/assets/media/tutorials/001-pragmatic-cucumber/chapter3/weston-mackinnon-au9N2rdOmOg-unsplash.jpg" />
<meta name="twitter:card" content="summary_large_image" />
<meta property="twitter:image" content="https://www.madrascoder.com/assets/media/tutorials/001-pragmatic-cucumber/chapter3/weston-mackinnon-au9N2rdOmOg-unsplash.jpg" />
<meta property="twitter:title" content="How to Convert a DataTable into a Java Object" />
<script type="application/ld+json">
{"url":"https://www.madrascoder.com/tutorials/001-pragmatic-cucumber/03-converting-datatable-to-java-object.html","image":"https://www.madrascoder.com/assets/media/tutorials/001-pragmatic-cucumber/chapter3/weston-mackinnon-au9N2rdOmOg-unsplash.jpg","headline":"How to Convert a DataTable into a Java Object","description":"This chapter is continuation of ‘Different patterns of creating Cucumber Feature files’ with more real use case. In this chapter, let us see 3 patterns to represent complex objects in feature files. In a real use case, we may need to convert the DataTable to a JSON so that we can use that as payload to call REST API from step definition. If we can convert DataTable to a Java Object, we can easily convert that to a JSON.","@type":"WebPage","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
    <nav>
    <ul class="menu">
        <li class="logo">
            <a href="https://www.madrascoder.com">Madras Coder</a>
        </li>
        <li class="toggle"><a href="#"><i onclick="toggleMenu(this)" class="toggle-menu fas fa-bars fa-2x"></i></a></li>
        <li class="item"><a href="https://www.madrascoder.com">Home</a></li>
        <li class="item"><a href="/articles">Articles</a></li>
        <li class="item"><a href="/tutorials">Tutorials</a></li>
        <li class="item"><a href="/about.html">About</a></li>
        <li class="item">
            <a href="#"><i onclick="toggleDarkMode(this)" class="fas fa-moon"></i></a>
        </li>
    </ul>
</nav>
    <main class="tutorial-content">
        <img src="/assets/media/tutorials/001-pragmatic-cucumber/chapter3/weston-mackinnon-au9N2rdOmOg-unsplash.jpg" title="How to Convert a DataTable into a Java Object" />
        <p></p>
        <h1>How to Convert a DataTable into a Java Object</h1>
        <p>This chapter is continuation of 'Different patterns of creating Cucumber Feature files' with more real use case.
In this chapter, let us see 3 patterns to represent complex objects in feature files. In a real use case, we may need to convert the DataTable to a JSON so that we can use that as payload to call REST API from step definition. If we can convert DataTable to a Java Object, we can easily convert that to a JSON.
</p>
        <hr>
        <p>Let’s imagine we are working on creating a HR Software and we need to implement the following requirement/user story.</p>

<p><strong>As a</strong> HR Staff,<br />
<strong>I want to</strong> to save a new employee details,<br />
<strong>So that</strong> I can refer to the details in the system when needed.</p>

<p>In order to implement this requirement/user story, let us create a feature file using the patterns we learnt earlier.</p>

<p>Let us assume the following fields represents the basic details of an employee,</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">java.time.LocalDate</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">lombok.Getter</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">lombok.Setter</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">lombok.ToString</span><span class="o">;</span>

<span class="nd">@Getter</span>
<span class="nd">@Setter</span>
<span class="nd">@ToString</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Employee</span> <span class="o">{</span>
  <span class="kd">private</span> <span class="nc">Long</span> <span class="n">id</span><span class="o">;</span>

  <span class="kd">private</span> <span class="nc">String</span> <span class="n">firstName</span><span class="o">;</span>
  <span class="kd">private</span> <span class="nc">String</span> <span class="n">lastName</span><span class="o">;</span>
  <span class="kd">private</span> <span class="nc">String</span> <span class="n">email</span><span class="o">;</span>

  <span class="kd">private</span> <span class="nc">LocalDate</span> <span class="n">dateOfBirth</span><span class="o">;</span>
  <span class="kd">private</span> <span class="kt">boolean</span> <span class="n">remoteWorker</span><span class="o">;</span>
  <span class="kd">private</span> <span class="nc">String</span> <span class="n">jobTitle</span><span class="o">;</span>
  
  <span class="kd">private</span> <span class="nc">String</span> <span class="n">employeeNumber</span><span class="o">;</span>
  <span class="kd">private</span> <span class="nc">String</span> <span class="n">employmentStatus</span><span class="o">;</span>
  <span class="kd">private</span> <span class="nc">String</span> <span class="n">employmentType</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></div></div>
<p>And the sample JSON representation is,</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
  </span><span class="nl">"firstName"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Effie"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"lastName"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Slee"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"email"</span><span class="p">:</span><span class="w"> </span><span class="s2">"eslee0@blueocean.com"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"dateOfBirth"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2000-01-01"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"remoteWorker"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
  </span><span class="nl">"jobTitle"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Physical Therapy Assistant"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"employeeNumber"</span><span class="p">:</span><span class="w"> </span><span class="mi">101</span><span class="p">,</span><span class="w">
  </span><span class="nl">"employeeStatus"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Active"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"employmentType"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Full-Time"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<hr />

<h3 id="pattern-one-step-per-field">Pattern: One Step Per Field</h3>

<p><strong>Feature File</strong></p>

<div class="language-cucumber highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">Feature</span><span class="p">:</span> Create Employee
  <span class="kn">Scenario</span><span class="p">:</span> Create employee with basic details
    <span class="nf">Given </span>employee first name is 'Effie'
    <span class="nf">And </span>employee last name is 'Slee'
    <span class="nf">And </span>employee email is 'eslee0@blueocean.com'
    <span class="nf">And </span>employee date of birth is '2000-01-01'
    <span class="nf">And </span>employee remote worker flag is 'false'
    <span class="nf">And </span>employee job title is 'Physical Therapy Assistant'
    <span class="nf">And </span>employee number is 'E101'
    <span class="nf">And </span>employment status is 'Active'
    <span class="nf">And </span>employment type is 'Full-Time'
  
    <span class="nf">When </span>user saves a new employee

    <span class="nf">Then </span>the save IS SUCCESSFUL
</code></pre></div></div>

<p><strong>Corresponding Step Definitions</strong></p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">com.madrascoder.cucumberbooksample.dto.Employee</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">io.cucumber.java.en.And</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">io.cucumber.java.en.Given</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">io.cucumber.java.en.Then</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">io.cucumber.java.en.When</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.time.LocalDate</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">EmployeeStepDefinitions</span> <span class="o">{</span>

  <span class="kd">private</span> <span class="nc">Employee</span> <span class="n">employee</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Employee</span><span class="o">();</span>

  <span class="nd">@Given</span><span class="o">(</span><span class="s">"employee first name is {string}"</span><span class="o">)</span>
  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">employeeFirstNameIs</span><span class="o">(</span><span class="nc">String</span> <span class="n">firstName</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">employee</span><span class="o">.</span><span class="na">setFirstName</span><span class="o">(</span><span class="n">firstName</span><span class="o">);</span>
  <span class="o">}</span>

  <span class="nd">@And</span><span class="o">(</span><span class="s">"employee last name is {string}"</span><span class="o">)</span>
  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">employeeLastNameIs</span><span class="o">(</span><span class="nc">String</span> <span class="n">lastName</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">employee</span><span class="o">.</span><span class="na">setLastName</span><span class="o">(</span><span class="n">lastName</span><span class="o">);</span>
  <span class="o">}</span>

  <span class="nd">@And</span><span class="o">(</span><span class="s">"employee email is {string}"</span><span class="o">)</span>
  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">employeeEmailIs</span><span class="o">(</span><span class="nc">String</span> <span class="n">email</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">employee</span><span class="o">.</span><span class="na">setEmail</span><span class="o">(</span><span class="n">email</span><span class="o">);</span>
  <span class="o">}</span>

  <span class="nd">@And</span><span class="o">(</span><span class="s">"employee date of birth is {string}"</span><span class="o">)</span>
  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">employeeJoiningDateIs</span><span class="o">(</span><span class="nc">String</span> <span class="n">dateOfBirthStr</span><span class="o">)</span> <span class="o">{</span>
    <span class="nc">LocalDate</span> <span class="n">dateOfBirth</span> <span class="o">=</span> <span class="nc">LocalDate</span><span class="o">.</span><span class="na">parse</span><span class="o">(</span><span class="n">dateOfBirthStr</span><span class="o">);</span>
    <span class="n">employee</span><span class="o">.</span><span class="na">setDateOfBirth</span><span class="o">(</span><span class="n">dateOfBirth</span><span class="o">);</span>
  <span class="o">}</span>

  <span class="nd">@And</span><span class="o">(</span><span class="s">"employee remote worker flag is {boolean}"</span><span class="o">)</span>
  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">employeeRemoteWorkerFlagIs</span><span class="o">(</span><span class="kt">boolean</span> <span class="n">remoteWorker</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">employee</span><span class="o">.</span><span class="na">setRemoteWorker</span><span class="o">(</span><span class="n">remoteWorker</span><span class="o">);</span>
  <span class="o">}</span>

  <span class="nd">@And</span><span class="o">(</span><span class="s">"employee job title is {string}"</span><span class="o">)</span>
  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">employeeJobTitleIs</span><span class="o">(</span><span class="nc">String</span> <span class="n">jobTitle</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">employee</span><span class="o">.</span><span class="na">setJobTitle</span><span class="o">(</span><span class="n">jobTitle</span><span class="o">);</span>
  <span class="o">}</span>

  <span class="nd">@And</span><span class="o">(</span><span class="s">"employee number is {string}"</span><span class="o">)</span>
  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">employeeNumberIs</span><span class="o">(</span><span class="nc">String</span> <span class="n">employeeNumber</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">employee</span><span class="o">.</span><span class="na">setEmployeeNumber</span><span class="o">(</span><span class="n">employeeNumber</span><span class="o">);</span>
  <span class="o">}</span>

  <span class="nd">@And</span><span class="o">(</span><span class="s">"employment status is {string}"</span><span class="o">)</span>
  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">employmentStatusIs</span><span class="o">(</span><span class="nc">String</span> <span class="n">employmentStatus</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">employee</span><span class="o">.</span><span class="na">setEmploymentStatus</span><span class="o">(</span><span class="n">employmentStatus</span><span class="o">);</span>
  <span class="o">}</span>

  <span class="nd">@And</span><span class="o">(</span><span class="s">"employment type is {string}"</span><span class="o">)</span>
  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">employmentTypeIs</span><span class="o">(</span><span class="nc">String</span> <span class="n">employmentType</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">employee</span><span class="o">.</span><span class="na">setEmploymentType</span><span class="o">(</span><span class="n">employmentType</span><span class="o">);</span>
  <span class="o">}</span>

  <span class="nd">@When</span><span class="o">(</span><span class="s">"user saves a new employee"</span><span class="o">)</span>
  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">userSavesANewEmployee</span><span class="o">()</span> <span class="o">{</span>
    <span class="c1">// call REST API to create employee</span>
    <span class="c1">// save REST API Response</span>
  <span class="o">}</span>

  <span class="nd">@Then</span><span class="o">(</span><span class="s">"the save IS SUCCESSFUL"</span><span class="o">)</span>
  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">theSaveIsSuccessful</span><span class="o">()</span> <span class="o">{</span>
    <span class="c1">// assert if Response status is 201 Created or 200 Ok.</span>
  <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>
<p>Creating step definitions for each step is time consuming, representations are some time hierarchical and it becomes very hard to maintain.</p>

<p>So, let us try another approach.</p>

<hr />

<h3 id="pattern-mapkey-value-datatable">Pattern: Map&lt;Key, Value&gt; DataTable</h3>

<p><strong>Feature File</strong></p>

<div class="language-cucumber highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">Feature</span><span class="p">:</span> Create Employee
  <span class="kn">Scenario</span><span class="p">:</span> Create employee with basic details
    <span class="nf">Given </span>user wants to create employee with following details
      <span class="p">|</span> <span class="nv">firstName</span>        <span class="p">|</span> <span class="nv">Effie</span>                      <span class="p">|</span>
      <span class="p">|</span> <span class="n">lastName</span>         <span class="p">|</span> <span class="n">Slee</span>                       <span class="p">|</span>
      <span class="p">|</span> <span class="n">email</span>            <span class="p">|</span> <span class="n">eslee@blueocean.com</span>        <span class="p">|</span> 
      <span class="p">|</span> <span class="n">dateOfBirth</span>      <span class="p">|</span> <span class="n">2000-01-01</span>                 <span class="p">|</span>
      <span class="p">|</span> <span class="n">remoteWorker</span>     <span class="p">|</span> <span class="n">false</span>                      <span class="p">|</span>
      <span class="p">|</span> <span class="n">jobTitle</span>         <span class="p">|</span> <span class="n">Physical</span> <span class="n">Therapy</span> <span class="n">Assistant</span> <span class="p">|</span>
      <span class="p">|</span> <span class="n">employeeNumber</span>   <span class="p">|</span> <span class="n">E101</span>                       <span class="p">|</span>
      <span class="p">|</span> <span class="n">employmentStatus</span> <span class="p">|</span> <span class="n">Active</span>                     <span class="p">|</span>
      <span class="p">|</span> <span class="n">employmentType</span>   <span class="p">|</span> <span class="n">Full-Time</span>                  <span class="p">|</span>

    <span class="nf">When </span>user saves a new employee

    <span class="nf">Then </span>the save IS SUCCESSFUL  
</code></pre></div></div>

<p><strong>Corresponding Step Definitions</strong></p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">com.fasterxml.jackson.databind.ObjectMapper</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.fasterxml.jackson.databind.SerializationFeature</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.fasterxml.jackson.datatype.jsr310.JavaTimeModule</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.madrascoder.cucumberbooksample.dto.Employee</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">io.cucumber.java.en.Given</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">io.cucumber.java.en.Then</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">io.cucumber.java.en.When</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.Map</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">EmployeeStepDefinitions</span> <span class="o">{</span>

  <span class="kd">private</span> <span class="nc">Employee</span> <span class="n">employee</span><span class="o">;</span>

  <span class="nd">@Given</span><span class="o">(</span><span class="s">"user wants to create employee with following details"</span><span class="o">)</span>
  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">userWantsToCreateEmployeeWithFollowingDetails</span><span class="o">(</span><span class="nc">Map</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">Object</span><span class="o">&gt;</span> <span class="n">employeeMap</span><span class="o">)</span> <span class="o">{</span>
    <span class="c1">// Create one instance of ObjectMapper and keep reusing every where, else autowire Spring's ObjectMapper bean</span>
    <span class="kd">final</span> <span class="nc">ObjectMapper</span> <span class="n">objectMapper</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ObjectMapper</span><span class="o">();</span>
    <span class="n">objectMapper</span><span class="o">.</span><span class="na">registerModule</span><span class="o">(</span><span class="k">new</span> <span class="nc">JavaTimeModule</span><span class="o">())</span>
        <span class="o">.</span><span class="na">disable</span><span class="o">(</span><span class="nc">SerializationFeature</span><span class="o">.</span><span class="na">WRITE_DATES_AS_TIMESTAMPS</span><span class="o">);</span>
    
    <span class="k">this</span><span class="o">.</span><span class="na">employee</span> <span class="o">=</span> <span class="n">objectMapper</span><span class="o">.</span><span class="na">convertValue</span><span class="o">(</span><span class="n">employeeMap</span><span class="o">,</span> <span class="nc">Employee</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
  <span class="o">}</span>

  <span class="nd">@When</span><span class="o">(</span><span class="s">"user saves a new employee"</span><span class="o">)</span>
  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">userSavesANewEmployee</span><span class="o">()</span> <span class="o">{</span>
    <span class="c1">// call REST API to create employee</span>
    <span class="c1">// save REST API Response</span>
  <span class="o">}</span>

  <span class="nd">@Then</span><span class="o">(</span><span class="s">"the save IS SUCCESSFUL"</span><span class="o">)</span>
  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">theSaveIsSuccessful</span><span class="o">()</span> <span class="o">{</span>
    <span class="c1">// assert if Response status is 201 Created or 200 Ok.</span>
  <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>
<p>Using Map&lt;String, Object&gt; DataTable made life little easy. But reading the Map DataTable is not easy. Most of us are used to spreadsheet style, header row at the top and all values under it. Reading Key on the left and value on the right in a DataTable may add some cognitive load.</p>

<p>In the next pattern, let’s do spreadsheet like DataTable.</p>

<hr />

<h3 id="pattern-spreadsheet-datatable">Pattern: Spreadsheet DataTable</h3>

<p><strong>Feature File</strong></p>

<div class="language-cucumber highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">Feature</span><span class="p">:</span> Create Employee

  <span class="kn">Scenario</span><span class="p">:</span> Create employee with basic details
    <span class="nf">Given </span>user wants to create employee with following details

      <span class="p">|</span> <span class="nv">firstName</span> <span class="p">|</span> <span class="nv">lastName</span> <span class="p">|</span> <span class="nv">email</span>               <span class="p">|</span> <span class="nv">dateOfBirth</span> <span class="p">|</span> <span class="nv">remoteWorker</span> <span class="p">|</span> <span class="nv">jobTitle</span>                   <span class="p">|</span> <span class="nv">employeeNumber</span> <span class="p">|</span> <span class="nv">employeeStatus</span> <span class="p">|</span> <span class="nv">employmentType</span> <span class="p">|</span>
      <span class="p">|</span> <span class="n">Effie</span>     <span class="p">|</span> <span class="n">Slee</span>     <span class="p">|</span> <span class="n">eslee@blueocean.com</span> <span class="p">|</span> <span class="n">2000-01-01</span>  <span class="p">|</span> <span class="n">false</span>        <span class="p">|</span> <span class="n">Physical</span> <span class="n">Therapy</span> <span class="n">Assistant</span> <span class="p">|</span> <span class="n">E101</span>           <span class="p">|</span> <span class="n">Active</span>         <span class="p">|</span> <span class="n">Full-Time</span>      <span class="p">|</span>

    <span class="nf">When </span>user saves a new employee

    <span class="nf">Then </span>the save IS SUCCESSFUL

</code></pre></div></div>

<p><strong>IMPORTANT NOTE:</strong> Header row in the data table contains the camelCase field names of Employee.java. This makes life easy for Cucumber to automatically convert the DataTable into a Employee Object. This is one of the convention that is going to help us a lot.</p>

<blockquote>
  <p>If needed, we can make the the Header row as Title Case, we can write a few lines of code to convert it to Java field names if we follow some convention.</p>
</blockquote>

<p><strong>Prerequisite for Step Definitions</strong></p>

<p>Before we implement the step definition, we need to create a generic data transformer which converts any DataTable to corresponding Java Object. Here is that <strong>magic</strong> class,</p>

<p>Create a class <code class="language-plaintext highlighter-rouge">src/test/com/madrascoder/cucumberbooksample/DataTransformer.java</code> and as stated below.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">com.fasterxml.jackson.databind.ObjectMapper</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">io.cucumber.java.DefaultDataTableCellTransformer</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">io.cucumber.java.DefaultDataTableEntryTransformer</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">io.cucumber.java.DefaultParameterTransformer</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.lang.reflect.Type</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">DataTransformer</span> <span class="o">{</span>

  <span class="c1">// Set spring.jackson.serialization.write-dates-as-timestamps=false </span>
  <span class="c1">// in application.properties</span>
  <span class="c1">// This is required to convert ISO 8601 Date String to LocalDate and </span>
  <span class="c1">// many other java.time package use cases</span>
  <span class="kd">private</span> <span class="kd">final</span> <span class="nc">ObjectMapper</span> <span class="n">objectMapper</span><span class="o">;</span>

  <span class="c1">// Spring will auto wire the ObjectMapper</span>
  <span class="kd">public</span> <span class="nf">DataTransformer</span><span class="o">(</span><span class="nc">ObjectMapper</span> <span class="n">objectMapper</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">this</span><span class="o">.</span><span class="na">objectMapper</span> <span class="o">=</span> <span class="n">objectMapper</span><span class="o">;</span>
  <span class="o">}</span>

  <span class="nd">@DefaultParameterTransformer</span>
  <span class="nd">@DefaultDataTableEntryTransformer</span>
  <span class="nd">@DefaultDataTableCellTransformer</span>
  <span class="kd">public</span> <span class="nc">Object</span> <span class="nf">transformer</span><span class="o">(</span><span class="nc">Object</span> <span class="n">fromValue</span><span class="o">,</span> <span class="nc">Type</span> <span class="n">toValueType</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">return</span> <span class="n">objectMapper</span><span class="o">.</span><span class="na">convertValue</span><span class="o">(</span><span class="n">fromValue</span><span class="o">,</span> 
                  <span class="n">objectMapper</span><span class="o">.</span><span class="na">constructType</span><span class="o">(</span><span class="n">toValueType</span><span class="o">));</span>
  <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<p>Also, set the following property in <code class="language-plaintext highlighter-rouge">application.properties</code>. This helps converting ISO 8601 Date and Time formats to java.time.* classes.</p>

<div class="language-properties highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="py">spring.jackson.serialization.write-dates-as-timestamps</span><span class="p">=</span><span class="s">false</span>
</code></pre></div></div>

<p><strong>Corresponding Step Definitions</strong></p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">com.madrascoder.cucumberbooksample.dto.Employee</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">io.cucumber.java.en.Given</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">io.cucumber.java.en.Then</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">io.cucumber.java.en.When</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">lombok.extern.slf4j.Slf4j</span><span class="o">;</span>

<span class="nd">@Slf4j</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">EmployeeStepDefinitions</span> <span class="o">{</span>

  <span class="kd">private</span> <span class="nc">Employee</span> <span class="n">employee</span><span class="o">;</span>

  <span class="nd">@Given</span><span class="o">(</span><span class="s">"user wants to create employee with following details"</span><span class="o">)</span>
  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">userWantsToCreateEmployeeWithFollowingDetails</span><span class="o">(</span><span class="nc">Employee</span> <span class="n">employee</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">log</span><span class="o">.</span><span class="na">info</span><span class="o">(</span><span class="s">"Employee: {}"</span><span class="o">,</span> <span class="n">employee</span><span class="o">);</span>
    <span class="k">this</span><span class="o">.</span><span class="na">employee</span> <span class="o">=</span> <span class="n">employee</span><span class="o">;</span>
  <span class="o">}</span>

  <span class="nd">@When</span><span class="o">(</span><span class="s">"user saves a new employee"</span><span class="o">)</span>
  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">userSavesANewEmployee</span><span class="o">()</span> <span class="o">{</span>
    <span class="c1">// call REST API to create employee</span>
    <span class="c1">// save REST API Response</span>
  <span class="o">}</span>

  <span class="nd">@Then</span><span class="o">(</span><span class="s">"the save IS SUCCESSFUL"</span><span class="o">)</span>
  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">theSaveIsSuccessful</span><span class="o">()</span> <span class="o">{</span>
    <span class="c1">// assert if Response status is 201 Created or 200 Ok.</span>
  <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<p>Look at the above step definition file, compare it with other patterns stated above. You will know how <code class="language-plaintext highlighter-rouge">DataTransformer.java</code> and <strong>Spreadsheet DataTable Pattern</strong> together made life easy.</p>

<p>There is one draw back here, if the object has more fields, viewing DataTable may require scrolling horizontally. If you are using a wide screen monitor, it can be avoided to some extent. Considering the fact that its easier for Product Owner to understand and developer to create step definitions, having to do the horizontal scroll is the trade off and it is worth it.</p>

<hr />

<h3 id="quick-tip">Quick Tip</h3>

<p>You may use below strategy to create DataTable header row. Remember to replace <code class="language-plaintext highlighter-rouge">Employee.class</code> with your respective class.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
    <span class="kd">final</span> <span class="nc">String</span> <span class="n">header</span> <span class="o">=</span> <span class="nc">Stream</span><span class="o">.</span><span class="na">of</span><span class="o">(</span><span class="nc">Employee</span><span class="o">.</span><span class="na">class</span><span class="o">.</span><span class="na">getDeclaredFields</span><span class="o">())</span>
        <span class="o">.</span><span class="na">map</span><span class="o">(</span><span class="nl">Field:</span><span class="o">:</span><span class="n">getName</span><span class="o">)</span>
        <span class="o">.</span><span class="na">collect</span><span class="o">(</span><span class="nc">Collectors</span><span class="o">.</span><span class="na">joining</span><span class="o">(</span><span class="s">"|"</span><span class="o">,</span> <span class="s">"|"</span><span class="o">,</span> <span class="s">"|"</span><span class="o">));</span>
    <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">header</span><span class="o">);</span>
  <span class="o">}</span>
</code></pre></div></div>

<p><strong>[OR]</strong></p>

<p>To generate mock data for DataTable, you may use Mockaroo custom formatter with pipe delimiter. For more information refer <a href="https://www.mockaroo.com/" target="_blank">https://www.mockaroo.com/</a></p>

<hr />

<h3 id="conclusion">Conclusion</h3>

<p>In this chapter, we saw 3 patterns</p>

<p><strong>1. One Step Per Field Pattern</strong><br />
<strong>2. Map&lt;Key, Object&gt; DataTable Pattern</strong><br />
<strong>3. Spreadsheet DataTable Pattern</strong></p>

<p>My recommendation is to use the <strong>Spreadsheet DataTable Pattern</strong> when ever you need  to represent a complex object in feature file.</p>

<blockquote>
  <p>You may be wondering, how can to represent hierarchical information in feature file using <strong>Spreadsheet DataTable Pattern</strong>. In the future chapter, I will introduce that when handling <code class="language-plaintext highlighter-rouge">One Employee can have Many Address</code> use case.</p>
</blockquote>

<p>In the next chapter, let’s apply <strong>Spreadsheet DataTable Pattern</strong> to test the REST API to ‘create employee’.</p>

<hr />

<h3 id="references">References</h3>

<p>For more information on <code class="language-plaintext highlighter-rouge">DataTransformer.java</code> you may refer <a href="https://cucumber.io/docs/cucumber/configuration/" target="_blank">https://cucumber.io/docs/cucumber/configuration/</a></p>

<hr />

<h3 id="credits">Credits</h3>

<p>Photo by <a href="https://unsplash.com/@chuttersnap?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" target="_blank">CHUTTERSNAP</a> on <a href="https://unsplash.com/s/photos/options?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" target="_blank">Unsplash</a></p>

<hr />

<p><a href="/tutorials/001-pragmatic-cucumber/02-diff-ways-of-creating-feature-files.html">Previous Chapter</a> | 
<a href="/tutorials/001-pragmatic-cucumber/03-converting-datatable-to-java-object.html">Scroll Up to Top</a> | 
<a href="/tutorials/001-pragmatic-cucumber/">Table of Contents</a> |
<a href="/tutorials/001-pragmatic-cucumber/04-implementing-create-resource.html">Next Chapter</a></p>


    </main>
    <footer>
    <section class="legal">
        <ul>
            <li><a href="#"><i class="far fa-copyright"></i> Madras Coder</a></li>
            <li><a href="#">SiteMap</a></li>
            <li><a href="#">Credits</a></li>
        </ul>
    </section>
    <section class="social">
        <ul>
            <li>
                <a href="https://www.twitter.com/bcarun" target="_blank">
                    <i class="fab fa-twitter fa-2x"></i>
                </a>
            </li>
            <li>
                <a href="https://stackoverflow.com/users/story/1535606" target="_blank">
                    <i class="fab fa-stack-overflow fa-2x"></i>
                </a>
            </li>
            <li>
                <a href="https://github.com/bcarun" target="_blank">
                    <i class="fab fa-github fa-2x"></i>
                </a>
            </li>
            <li>
                <a href="https://www.linkedin.com/in/bcarun/" target="_blank">
                    <i class="fab fa-linkedin-in fa-2x"></i>
                </a>
            </li>
        </ul>
    </section>
</footer>
    <script src="/assets/scripts.js"></script>
</body>

</html>